replicaCount: 1

image:
  repository: ghcr.io/fredericrous/duro-app
  pullPolicy: IfNotPresent
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  annotations: {}
  name: ""

podAnnotations: {}

podSecurityContext:
  fsGroup: 1001

securityContext:
  runAsUser: 1001
  runAsNonRoot: true
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop: ["ALL"]

# Shared env vars
env:
  NODE_TLS_REJECT_UNAUTHORIZED: "0"
  SMTP_HOST: "stalwart.stalwart.svc.cluster.local."
  SMTP_PORT: "587"
  SMTP_USER: "admin"
  SMTP_FROM: "noreply@daddyshome.fr"
  INVITE_BASE_URL: "https://join.daddyshome.fr"
  NAS_VAULT_ADDR: "https://vault.vault.mesh:15443"
  OTEL_EXPORTER_OTLP_ENDPOINT: "http://alloy.monitoring.svc.cluster.local.:4318"
  DURO_DB_PATH: "/db/duro.sqlite"
  APP_NAME: "Daddyshome"
  APP_DESCRIPTION: "a private platform for media, productivity, and more"
  ALLOWED_ORIGIN_SUFFIX: "daddyshome.fr"
  HOME_URL: "https://home.daddyshome.fr"
  ADMIN_GROUP_NAME: "lldap_admin"
  SYSTEM_USERS: "admin,gitea-service"

envFrom: []

# Web-specific config
web:
  port: 3000
  otelServiceName: "duro"
  env:
    LLDAP_URL: "http://lldap.lldap.svc.cluster.local.:17170"
    LLDAP_ADMIN_USER: "admin"
  resources:
    requests:
      memory: "96Mi"
      cpu: "50m"
    limits:
      memory: "192Mi"
      cpu: "300m"
  appsConfig:
    enabled: true
    configMapName: "duro-apps"
    apps:
      - id: plex
        name: Plex
        url: https://plex.daddyshome.fr
        category: media
        icon: plex
        groups: [lldap_password_manager, lldap_admin]
        priority: 1
      - id: stremio
        name: Stremio
        url: https://stremio.daddyshome.fr
        category: media
        icon: stremio
        groups: [lldap_password_manager, lldap_admin]
        priority: 2
      - id: kyoo
        name: Kyoo
        url: https://kyoo.daddyshome.fr
        category: media
        icon: kyoo
        groups: [lldap_password_manager, lldap_admin]
        priority: 3
      - id: openwebui
        name: Open WebUI
        url: https://ai.daddyshome.fr
        category: ai
        icon: openwebui
        groups: [lldap_password_manager, lldap_admin]
        priority: 1
      - id: nextcloud
        name: Nextcloud
        url: https://cloud.daddyshome.fr
        category: productivity
        icon: nextcloud
        groups: [lldap_password_manager, lldap_admin]
        priority: 1
      - id: immich
        name: Immich
        url: https://photos.daddyshome.fr
        category: productivity
        icon: immich
        groups: [lldap_password_manager, lldap_admin]
        priority: 2
      - id: lldap
        name: LLDAP
        url: https://lldap.daddyshome.fr
        category: admin
        icon: lldap
        groups: [lldap_admin]
        priority: 1

# Worker config
worker:
  enabled: false
  port: 3001
  otelServiceName: "duro-worker"
  env: {}
  resources:
    requests:
      memory: "64Mi"
      cpu: "20m"
    limits:
      memory: "128Mi"
      cpu: "200m"

database:
  mode: sqlite  # "sqlite" or "postgres"

persistence:
  enabled: true
  storageClass: ""
  size: 1Gi
  accessModes:
    - ReadWriteOnce

internalCA:
  enabled: true
  secretName: "duro-internal-ca"

nodeSelector: {}
tolerations: []
affinity: {}
